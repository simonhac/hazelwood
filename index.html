<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>is hazelwood online?</title>
  <meta name="description" content="Is Hazelwood power station online?">
  <meta name="author" content="simon holmes Ã  court; steven tan">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="https://fonts.googleapis.com/css?family=Abel|Source+Code+Pro" rel="stylesheet">
  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/skeleton.css">
  <link rel="stylesheet" href="css/index.css">
  <link rel="icon" type="image/png" href="images/favicon-32x32.png">
</head>
<body>
  <!-- <img src="images/power-station.jpg" class="station"> -->
  <img src="images/hazelwood.jpg" class="station2">
  <div class="container">
    <div class="row">
      <div class="twelve column">
        <div id="loading">fetching...</div>
        <div id="hero-text" class="main">
          <h5>Hazelwood is generating <span id="output"></span> MW and emitting</h5>
          <div>
            <h1><span id="emissions"></span> kg CO<sub>2</sub></h1>
            <h4>per second</h4>
          </div>
            <h5 id="nasty"></h5>
        </div>
        <div class="chart">
      		<canvas id="canvas"></canvas>
        </div>

        <hr>
        <div class="futureSuper">
          <h5>Victoria is increasingly being powered by <strong>renewable energy</strong>.<br>
            <strong>Your super can be too</strong>.</h5>
          <a id="joinSuper" href="https://www.myfuturesuper.com.au/switch/join-future-super?utm_campaign=hazelwood&utm_medium=referral">
            join Future Super in 2 minutes.
          </a>
        </div>

        <hr style="margin-top: 40px;">
        <footer>
          <p>
            <small>designed by </small><br>
            simonhac &amp; <a href="https://twitter.com/chienleng">@chienleng</a><br>
            <small>melbourne, australia</small><br>
          </p>
        </footer>
      </div>
    </div>
  </div>

<script src="js/Chart.bundle.min.js"></script>
<script src="js/moment.min.js"></script>
<script src="js/nanoajax.min.js"></script>
<script src="js/chartConfig.js"></script>
<script src="js/client.js"></script>

<script type="text/javascript">
  /* http://www.npi.gov.au/ -- using 2013/2014 data, since 2014 was the big fire */
  var nasties = [
	  '74 kg of arsenic',
	  '6,900,000 kg of carbon monoxide',
	  '7,700,000 kg of hydrochloric acid',
	  '140 kg of lead',
	  '25,000,000 kg of nitrogen oxides',
	  '4,800,000 kg of fine particulate matter',
	  '14,000,000 kg of sulfur dioxide',
	  '27,000 kg of sulfuric acid'
  ];

  function calculateEmissions(lastTotal) {
  	// intensity from ACIL Allen consulting
    return Math.round((lastTotal * 1558) / 3600);
  }

  window.onload = function() {
	  var refresh = 2 * 60 * 1000;
	  //  var refresh = 5000;

	  function loadUp() {
		  getDispatchData('https://bf3rcucqz0.execute-api.ap-southeast-2.amazonaws.com/prod/dispatch-data', function (lastTotal) {
			  updateStats(lastTotal, calculateEmissions(lastTotal))
		  });
	  }

	  var ctx = document.getElementById('canvas').getContext('2d');

	  config.data = setupChart();
	  window.chart = new Chart(ctx, config);

	  showNasties(nasties);

	  loadUp();
	  setInterval(function () {
		  loadUp();
	  }, refresh);

    // sending join super event
    document.getElementById('joinSuper').addEventListener('click', function() {
      ga('send', {
        hitType: 'event',
        eventCategory: 'Join Future Super',
        eventAction: 'clickThrough',
      });
      console.log('send event')
		});
  };

  // GA
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-96115117-1', 'auto');
  ga('send', 'pageview');
</script>

</body>
</html>
